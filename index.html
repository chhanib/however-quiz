<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>'However' Usage Quiz</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .quiz-container {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 800px;
            width: 90%;
        }
        h1, h2 {
            color: #003972;
            text-align: center;
            margin-bottom: 20px;
        }
        .question {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        .options {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        button {
            background-color: #003972;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 4px 2px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #002855;
        }
        .btn-correct {
            background-color: #ED5E42;
        }
        .btn-incorrect {
            background-color: #7F7F7F;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        #result, #statistics {
            margin-top: 20px;
            text-align: center;
        }
        #progress-bar {
            width: 100%;
            background-color: #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        #progress {
            width: 0;
            height: 20px;
            background-color: #ED5E42;
            border-radius: 5px;
            transition: width 0.5s;
        }
        #clear-data {
            background-color: #7F7F7F;
            margin-top: 20px;
        }
        #clear-data:hover {
            background-color: #6A6A6A;
        }
        #chart-container {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
        }
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .stats-table th, .stats-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .stats-table th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <h1>'However' Usage Quiz</h1>
        <div id="progress-bar">
            <div id="progress"></div>
        </div>
        <div id="question-container"></div>
        <div class="navigation">
            <button id="prev-button" onclick="showPreviousQuestion()" style="display:none;">Previous</button>
            <button id="next-button" onclick="showNextQuestion()">Next</button>
        </div>
        <div id="result"></div>
        <div id="statistics"></div>
        <div id="chart-container">
            <canvas id="statsChart"></canvas>
        </div>
        <button id="clear-data" onclick="clearAllData()" style="display:none;">Clear All Data</button>
    </div>

    <script>
        const questions = [
            "Parliamentary elections were held three times over the period analysed â€“ in 2010, 2016, and 2020, however the role of elections was not mentioned as a factor in governmental decision-making for social protection.",
            "I would, however, like to stress that universal benefits are the only means of effectively reaching the poorest members of society.",
            "The Iraqi government provides in-service training for teachers, however there is no clear indication of the specific training or professional development available for teachers in disability inclusive education.",
            "However, the approach taken by UNICEF has resulted in a range of challenges.",
            "One parent explained that they were offered treatment overseas by the MoH, however they were unable to accept the offer as they could not afford to pay for passport fees and were therefore unable to travel.",
            "There is, however, nothing wrong with the overall design of the system.",
            "At the PHC level, surveillance services are also available which can support early diagnosis and access to treatments for the prevention of disabilities, however, this service is limited in its delivery and impact.",
            "I do not know whether the Government would, however, be interested in implementing a more inclusive old age pension.",
            "In the preceding two decades the Human Development Index (HDI) trended upwards, however the period of 2012-2021 has been marked by more or less stagnant HDI improvements."
        ];

        let currentQuestion = 0;
        const responses = new Array(questions.length).fill(null);
        let chart;

        function showQuestion(index) {
            const questionContainer = document.getElementById('question-container');
            questionContainer.innerHTML = `
                <div class="question">${index + 1}. ${questions[index]}</div>
                <div class="options">
                    <button onclick="selectOption('correct', ${index})" class="${responses[index] === 'correct' ? 'btn-correct' : ''}">Correct</button>
                    <button onclick="selectOption('incorrect', ${index})" class="${responses[index] === 'incorrect' ? 'btn-incorrect' : ''}">Incorrect</button>
                </div>
            `;

            document.getElementById('prev-button').style.display = index > 0 ? 'inline-block' : 'none';
            document.getElementById('next-button').textContent = index < questions.length - 1 ? 'Next' : 'Submit';
            updateProgressBar();
        }

        function selectOption(option, index) {
            responses[index] = option;
            showQuestion(index);
        }

        function showNextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                submitQuiz();
            }
        }

        function showPreviousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function submitQuiz() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<h2>Thank you for completing the quiz!</h2>`;
            saveResponses(responses);
            showStatistics();
            document.getElementById('clear-data').style.display = 'block';
        }

        function saveResponses(responses) {
            let allResponses = JSON.parse(localStorage.getItem('quizResponses')) || [];
            allResponses.push(responses);
            localStorage.setItem('quizResponses', JSON.stringify(allResponses));
        }

        function showStatistics() {
            const allResponses = JSON.parse(localStorage.getItem('quizResponses')) || [];
            const totalResponses = allResponses.length;
            const stats = questions.map(() => ({correct: 0, incorrect: 0}));

            allResponses.forEach(response => {
                response.forEach((answer, index) => {
                    if (answer === 'correct') stats[index].correct++;
                    if (answer === 'incorrect') stats[index].incorrect++;
                });
            });

            let statsHtml = `<h2>Overall Statistics (${totalResponses} responses)</h2>`;
            statsHtml += `<table class="stats-table">
                            <tr>
                                <th>Question</th>
                                <th>Correct</th>
                                <th>Incorrect</th>
                            </tr>`;
            
            stats.forEach((stat, index) => {
                const total = stat.correct + stat.incorrect;
                const correctPercentage = total > 0 ? ((stat.correct / total) * 100).toFixed(2) : 0;
                const incorrectPercentage = total > 0 ? ((stat.incorrect / total) * 100).toFixed(2) : 0;
                
                statsHtml += `<tr>
                                <td>Question ${index + 1}</td>
                                <td>${stat.correct} (${correctPercentage}%)</td>
                                <td>${stat.incorrect} (${incorrectPercentage}%)</td>
                              </tr>`;
            });
            
            statsHtml += `</table>`;
            document.getElementById('statistics').innerHTML = statsHtml;

            createChart(stats, totalResponses);
        }

        function createChart(stats, totalResponses) {
            const ctx = document.getElementById('statsChart').getContext('2d');
            
            const labels = stats.map((_, index) => `Q${index + 1}`);
            const correctData = stats.map(stat => (stat.correct / totalResponses) * 100);
            const incorrectData = stats.map(stat => (stat.incorrect / totalResponses) * 100);

            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Correct (%)',
                        data: correctData,
                        backgroundColor: '#ED5E42',
                        borderColor: '#ED5E42',
                        borderWidth: 1
                    }, {
                        label: 'Incorrect (%)',
                        data: incorrectData,
                        backgroundColor: '#7F7F7F',
                        borderColor: '#7F7F7F',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Percentage'
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Question Statistics'
                        }
                    }
                }
            });
        }

        function updateProgressBar() {
            const progress = document.getElementById('progress');
            const percentage = ((currentQuestion + 1) / questions.length) * 100;
            progress.style.width = `${percentage}%`;
        }

        function clearAllData() {
            if (confirm("Are you sure you want to clear all stored quiz data? This action cannot be undone.")) {
                localStorage.removeItem('quizResponses');
                document.getElementById('statistics').innerHTML = '';
                document.getElementById('result').innerHTML = '<h2>All data has been cleared.</h2>';
                document.getElementById('clear-data').style.display = 'none';
                if (chart) {
                    chart.destroy();
                }
            }
        }

        // Initialize the quiz
        showQuestion(currentQuestion);
    </script>
</body>
</html>
